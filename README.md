# SmartHome

ตัวอย่างการสั่งเปิด-ปิดไฟ เมื่อเรากลับถึงบ้าน ฯลฯ  โดยทำงานร่วมกับแอพ LIFE360 และ IFTTT สั่งงานไปยัง Blynk เพื่อให้เปิด-ปิดไฟ ถ้าเรามาถึงบ้านแล้ว

# สิ่งที่ทำได้
1. เปิดไฟกรณีเรามาถึงบ้าน หรือ คนแรกมาถึงสถานที่ ที่กำหนดไว้ 
2. ปิดไฟกรณีเราออกจากบ้าน หรือ คนสุดท้ายออกจากสถานที่
3. สร้างไอเดียอื่นๆ เขียนเพิ่มได้ใน API เช่น กำหนดเวลาเฉพาะช่วงกลาคืน ถ้ากลับบ้านให้ทำงาน ตอนเช้าไม่ต้องทำงาน
3. แจ้งเตือนผ่าน LINE Notify 

# สิ่งที่ต้องมี
1. Blynk
2. ESP8266 หรืออย่างอิ่น เอาไว้ควบคุม Relay
3. แอพ LIFE360 (ในที่นี้จะไม่พูดเรื่องการใช้งานแอพนี้ และต้องสร้างสถานที่ในแอพนี้ไว้ด้วย)
4. แอพ IFTTT 
5. มี Web Server สำหรับเอาไว้รันไฟล์จาก Webhooks 
6. (หากไม่มี Web Server เพื่อฝากไฟล์ มาใช้เซิฟเวอร์ส่วนตัวของผมได้ฟรี www.remotecloud.info)
7. ความรู้พื้นฐานด้าน PHP 

## เตรียมพร้อมก่อนลงมือทำ
 * สร้างสถานที่ในแอพ LIFE360 ให้พร้อม
 * เตรียม Token ของ Line และของ Blynk ให้พร้อม
 * สามารถสั่งเปิดปิดไฟผ่านแอพ Blynk ได้แล้ว เพราะในเนื้อหานี้จะไม่เอ่ยถึงวิธีการทำส่วนนี้
# ขั้นตอนการทำ
 * เข้าเว็บ https://ifttt.com/ สมัครสมาชิกให้เรียบร้อย พร้อมล็อตอิน
 * ทำการสร้าง Applets ของเราใหม่ โดยเลือก Service LIFE360
 ![Img1](https://www.remotecloud.info/github_img/github_1.png)
 * จากนั้นเลือกเงื่อนไขว่าเราจะทำอะไร
 - 1.ถ้าเราไปถึงสถานที่ที่กำหนด
 - 2.ถ้าเราออกจากสถานที่ที่กำหนด
 - 3.ถ้าสมาชิกในบ้านคนแรก มาถึงสถานที่ที่กำหนด
 - 4.ถ้าสมาชิกในบ้านคนสุดท้าย ออกจากสถานที่ที่กำหนด
 * ตัวอย่างนี้เลือกอันแรก ถ้าเราไปถึงสถานที่ที่กำหนด ก็เลือกอันแรกไปเลย
  ![Img1](https://www.remotecloud.info/github_img/github_2.png)
  * เราต้องเชื่อมต่อกับระบบของ LIFE360 ก่อน โดยล็อคอินเข้าไปได้เลย
  * แต่หน้านี้ผมเคยเชื่อมต่อกับระบบแล้ว จะขึ้นให้เลือกสถานที่แทน เราต้องการสถานที่ไหนก็เลือกได้เลย
    ![Img1](https://www.remotecloud.info/github_img/github_3.png)
 * ต่อไปให้เลือก That ตัวสีดำๆ 
     ![Img1](https://www.remotecloud.info/github_img/github_4.png)
* แล้วค้นหา Webhooks
       ![Img1](https://www.remotecloud.info/github_img/github_5.png)
 * เลือก Make a web request
 * ช่อง URL กรอกลิงค์ API ที่เรานำไฟล์ไว้ เช่น https://domain.com/api.php?action=on_light (ตรง action=on_light คือสั่งให้เปิดไฟ ถ้าปิดไฟจะเป็น off_light)
 * จากนั้นกด Create ด้านล่าง 
 * ขั้นต่อไป ตรงนี้สามารถเปลี่ยนชื่อได้ และถ้าเลือก Receive notifications when this Applet runs ตัวแอพจะแจ้งเตือนด้วยอีกที (แนะนำให้ปิด)
 
  ![Img1](https://www.remotecloud.info/github_img/github_6.png)
  # สิ้นสุดวิธีตั้งค่า
  # ในส่วนวิธีแก้ไข API ลองศึกษาดูนะครับ ไม่ยาก
  * Code By U-karat Limkunakoon
  
